<%
const date = new Date().toLocaleString("ja-JP", {
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit"
}).replaceAll("/", "").replaceAll(" ", "").replaceAll(":", "");

const getMods = (modNum) => {
    let mod = new Array(0);
    const mods = [
        "nf", // 0 : NoFail
        "ez", // 1 : Eazy
        "ts", // 2 : TouchScreen
        "hd", // 3 : Hidden
        "hr", // 4 : HardRock
        "sd", // 5 : SaddenDeath
        "dt", // 6 : DoubleTime
        "rx", // 7 : Relax
        "ht", // 8 : HalfTime
        "nc", // 9 : NightCore
        "fl", // 10 : FlashLight
        "at", // 11 : AutoPlay
        "so", // 12 : SpinOut
        "ap", // 13 : Autopilot
        "pf", // 14 : Perfect
        "k4", // 15 : Key4
        "k5", // 16 : Key5
        "k6", // 17 : Key6
        "k7", // 18 : Key7
        "k8", // 19 : Key8
        "fi", // 20 : FadeIn
        "rd", // 21 : Random
        "cm", // 22 : Cinema
        "tp", // 23 : TargetPoint
        "k9", // 24 : Key9
        "kc", // 25 : KeyCoop
        "k1", // 26 : Key1
        "k3", // 27 : Key3
        "k2", // 28 : Key2
        "v2", // 29 : ScoreV2
        "mr"  // 30 : Mirror
    ];
    for (let i = 30; i >= 0; i--) {
        if (i !== 2 && i !== 11 && i !== 19 && i !== 22 && !(i >= 24 && i <= 28) && modNum >= 1 << i) {
            switch (i) {
                case 14:
                    modNum -= 1 << 5;
                    break;
                case 9:
                    modNum -= 1 << 6;
                    break;
            }
            mod.push(mods[i]);
            modNum -= 1 << i;
        }
    }
    mod = sortMods(mod);
    return mod;
}
const sortMods = (mods) => {
    const order = ["rx", "ap", "k4", "k5", "k6", "k7", "nf", "ez", "ht", "hd", "hr", "dt", "nc", "sd", "pf", "fl", "fi", "rd", "mr", "so", "v2"];
    let rst = new Array(0);
    for (let i = 0; i < order.length; i++) {
        for (let mod of mods) {
            if (mod === order[i]) {
                rst.push(mod);
                break;
            }
        }
    }
    return rst;
}

const getMode = (modeNum) => {
    switch (modeNum) {
        case 0: return "osu";
        case 1: return "taiko";
        case 2: return "fruits";
        case 3: return "mania";
    }
}
%>
<!-- best performance -->
<div class="box bestpp">
    <h1><i class="fa-regular fa-chart-bar"></i>Best Performance</h1>
    <div class="mode-<%= modeNum %>">
        <% let amt = 0; %>
        <% if (bestpp.length === 0) { %>
            <h1 class="nothing">No scores available</h1>
        <% } else { %>
            <% bestpp.forEach((data) => { %>
                <div class="wrap data">
                    <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= !dans ? data.beatmap.set_id : data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <a
                    <% if (!dans && data.beatmap.id > 0) { %>
                        href="/beatmaps/<%= data.beatmap.set_id %>/<%= data.beatmap.id %>"
                            <% } %>
                        style="width: calc(100% - 320px - <%= Math.min(35 * getMods(data.mods).length, 325) %>px);">
                        <p class="title"><%= !dans ? data.beatmap.title : data.title %> by <%= !dans ? data.beatmap.artist : data.artist %></p>
                        <p class="diff"><%= !dans ? data.beatmap.version : data.version %></p>
                    </a>
                    <div class="mods">
                        <% getMods(data.mods).forEach((mod) => { %>
                            <img title="<%= mod %>" class="img" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% }); %>
                    </div>
                    <p class="acc"><%= data.acc.toFixed(2) %>%</p>
                    <div class="pp">
                        <p class="recorded"
                        <% if (dans) { %>
                           style="margin: auto;"
                                <% } %>>
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } %>
                        </p>
                        <% if (!dans) { %>
                            <p class="weighted">(<%= Math.round(data.pp * Math.pow(0.95, amt)).toLocaleString() %>pp)</p>
                        <% } %>
                    </div>
                </div>
                <div class="data-mobile">
                    <div class="flex info">
                        <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= !dans ? data.beatmap.set_id : data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <a
                        <% if (!dans && data.beatmap.id > 0) { %>
                            href="/beatmaps/<%= data.beatmap.set_id %>/<%= data.beatmap.id %>"
                                <% } %>>
                            <p class="title"><%= !dans ? data.beatmap.title : data.title %> by <%= !dans ? data.beatmap.artist : data.artist %></p>
                            <p class="diff"><%= !dans ? data.beatmap.version :data.version %></p>
                        </a>
                        <% if (data.mods !== 0) { %>
                            <div class="mods">
                                <% getMods(data.mods).forEach((mod) => { %>
                                    <img title="<%= mod %>" class="img" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                                <% }); %>
                            </div>
                        <% } %>
                    </div>
                    <div class="flex results">
                        <p class="acc"><%= data.acc.toFixed(2) %>%</p>
                        <p class="recorded">
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } %>
                        </p>
                        <% if (!dans) { %>
                            <p class="weighted">(<%= Math.round(data.pp * Math.pow(0.95, amt++)).toLocaleString() %>pp)</p>
                        <% } %>
                    </div>
                </div>
            <% }); %>
        <% } %>
    </div>
</div>
<% for (let i = 0; i * 50 < bestpp.length; i++) { %>
    <% if (i === 0) { %>
        <% if (bestpp.length > 5) { %>
            <button class="show-more bp to50">
                <i class="fa-solid fa-chevron-down arrow down"></i>
                show more
                <i class="fa-solid fa-chevron-down arrow down"></i>
            </button>
        <% } %>
    <% } else { %>
        <button class="show-more bp to<%= (i + 1) * 50 %>" style="display: none">
            <i class="fa-solid fa-chevron-down arrow down"></i>
            show more
            <i class="fa-solid fa-chevron-down arrow down"></i>
        </button>
    <% } %>
<% } %>
<!-- first place -->
<div class="box first_place">
    <h1><i class="fa-solid fa-medal"></i>First Place Ranks</h1>
    <div class="mode-<%= modeNum %>">
        <% amt = 0; %>
        <% if (firstPlace.length === 0) { %>
            <h1 class="nothing">No scores available</h1>
        <% } else { %>
            <% firstPlace.forEach((data) => { %>
                <div class="wrap data">
                    <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <a
                    <% if (!dans && data.id > 0) { %>
                        href="/beatmaps/<%= data.set_id %>/<%= data.id %>"
                            <% } %>
                        style="width: calc(100% - 320px - <%= Math.min(35 * getMods(data.mods).length, 325) %>px);">
                        <p class="title"><%= data.title %> by <%= data.artist %></p>
                        <p class="diff"><%= data.version %></p>
                    </a>
                    <div class="mods">
                        <% getMods(data.mods).forEach((mod) => { %>
                            <img title="<%= mod %>" class="img" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% }); %>
                    </div>
                    <p class="acc"><%= data.acc.toFixed(2) %>%</p>
                    <div class="pp">
                        <p class="recorded"
                        <% if (dans) { %>
                           style="margin: auto";
                                <% } %>>
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } %>
                        </p>
                        <% if (!dans) { %>
                            <p class="weighted"></p>
                        <% } %>
                    </div>
                </div>
                <div class="data-mobile">
                    <div class="flex info">
                        <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <a
                        <% if (!dans && data.id > 0) { %>
                            href="/beatmaps/<%= data.set_id %>/<%= data.id %>"
                                <% } %>>
                            <p class="title"><%= data.title %> by <%= data.artist %></p>
                            <p class="diff"><%= data.version %></p>
                        </a>
                        <% if (data.mods !== 0) { %>
                            <div class="mods">
                                <% getMods(data.mods).forEach((mod) => { %>
                                    <img title="<%= mod %>" class="img" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                                <% }); %>
                            </div>
                        <% } %>
                    </div>
                    <div class="flex results">
                        <p class="acc"><%= data.acc.toFixed(2) %>%</p>
                        <p class="recorded">
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } %>
                        </p>
                        <% if (!dans) { %>
                            <p class="weighted"></p>
                        <% } %>
                    </div>
                </div>
            <% }); %>
        <% } %>
    </div>
</div>
<% for (let i = 0; i * 50 < firstPlace.length; i++) { %>
    <% if (i === 0) { %>
        <% if (firstPlace.length > 5) { %>
            <button class="show-more fp to50">
                <i class="fa-solid fa-chevron-down arrow down"></i>
                show more
                <i class="fa-solid fa-chevron-down arrow down"></i>
            </button>
        <% } %>
    <% } else { %>
        <button class="show-more fp to<%= (i + 1) * 50 %>" style="display: none">
            <i class="fa-solid fa-chevron-down arrow down"></i>
            show more
            <i class="fa-solid fa-chevron-down arrow down"></i>
        </button>
    <% } %>
<% } %>
<!-- most plays -->
<div class="box mostplays">
    <h1><i class="fa-regular fa-circle-play"></i>Most Plays</h1>
    <div class="mode-<%= modeNum %>">
        <% if (mostplays.length <= 0) { %>
            <h1 class="nothing">No scores available</h1>
        <% } else { %>
            <% mostplays.forEach((data) => { %>
                <div class="data"
                <% if (dans) { %>
                     style="height: 55px;"
                        <% } %>>
                    <% if (!dans) { %>
                        <img src="https://b.ppy.sh/thumb/<%= data.set_id %>l.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% } %>
                    <a
                    <% if (!dans && data.id > 0) { %>
                        href="/beatmaps/<%= data.set_id %>/<%= data.id %>"
                            <% } %>>
                        <p class="title"><%= data.title %> [<%= data.version%>] by <%= data.artist %></p>
                        <p class="mapper">mapped by <span><%= data.creator %></span></p>
                    </a>
                    <i class="mode-icon mode-<%= getMode(data.mode) %>"></i>
                    <div>
                        <i class="fa-solid fa-play play-icon"></i>
                        <p class="value"><%= data.plays.toLocaleString() %></p>
                    </div>
                </div>
                <div class="data-mobile"
                <% if (dans) {%>
                     style="height: 54px;"
                        <% } %>>
                    <div class="mapbg"
                    <% if (dans) {%>
                         style="background-color: unset; height: 54px;"
                            <% } %>>
                        <% if (!dans) { %>
                            <img src="https://b.ppy.sh/thumb/<%= data.set_id %>l.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% } %>
                        <div>
                            <i class="fa-solid fa-play play-icon"></i>
                            <p class="value"><%= data.plays.toLocaleString() %></p>
                        </div>
                    </div>
                    <a
                    <% if (!dans && data.id > 0) { %>
                        href="/beatmaps/<%= data.set_id%>/<%= data.id %>"
                            <% } %>>
                        <p class="title"><%= data.title %> [<%= data.version%>] by <%= data.artist %></p>
                        <p class="mapper">mapped by <span><%= data.creator %></span></p>
                    </a>
                    <i class="mode-icon mode-<%= getMode(data.mode) %>"></i>
                </div>
            <% }); %>
        <% } %>
    </div>
</div>
<% for (let i = 0; i * 50 < mostplays.length; i++) { %>
    <% if (i === 0) { %>
        <% if (mostplays.length > 5) { %>
            <button class="show-more mp to50">
                <i class="fa-solid fa-chevron-down arrow down"></i>
                show more
                <i class="fa-solid fa-chevron-down arrow down"></i>
            </button>
        <% } %>
    <% } else { %>
        <button class="show-more mp to<%= (i + 1) * 50 %>" style="display: none">
            <i class="fa-solid fa-chevron-down arrow down"></i>
            show more
            <i class="fa-solid fa-chevron-down arrow down"></i>
        </button>
    <% } %>
<% } %>
<!-- recent plays -->
<div class="box recentplays">
    <div class="flex">
        <h1><i class="fa-regular fa-calendar-days"></i>Recent Plays</h1>
        <button class="all">Show all</button>
        <button class="passed" style="filter: invert(0%); opacity: 1;">Only passed</button>
    </div>
    <div class="mode-<%= modeNum %>">
        <!-- Show all -->
        <% if (rsplays.length <= 0) { %>
            <h1 class="nothing" style="display: none;">No scores available</h1>
        <% } else { %>
            <% rsplays.forEach((data) => { %>
                <div class="data" style="display: none;">
                    <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= !dans ? data.beatmap.set_id : data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% if (!dans || (data.sacc >= data.dacc && data.sscore >= data.dscore)) { %>
                        <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% } else { %>
                        <img class="grade" src="/image/grade/F.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% } %>
                    <a
                    <% if (!dans && data.beatmap.id > 0) { %>
                        href="/beatmaps/<%= data.beatmap.set_id %>/<%= data.beatmap.id %>"
                            <% } %>
                        style="width: calc(100% - 320px - <%= Math.min(35 * getMods(data.mods).length, 325) %>px);">
                        <p class="title"><%= !dans ? data.beatmap.title : data.title %> by <%= !dans ? data.beatmap.artist : data.artist %></p>
                        <p class="diff"><%= !dans ? data.beatmap.version : data.version %></p>
                    </a>
                    <div class="mods">
                        <% getMods(data.mods).forEach((mod) => { %>
                            <img title="<%= mod %>" class="mod" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% }); %>
                    </div>
                    <p class="acc">
                        <% if (dans) { %>
                            <%= data.sacc.toFixed(2) %>
                        <% } else { %>
                            <%= data.acc.toFixed(2) %>
                        <% } %>
                        %
                    </p>
                    <div class="pp">
                        <p class="recorded">
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else if (data.grade !== "F") { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                -
                            <% } %>
                        </p>
                        <p class="loved">
                            <% if (!dans && data.beatmap.status !== 2 && data.beatmap.status !== 3) { %>
                                (Loved)
                            <% } %>
                        </p>
                    </div>
                </div>
                <div class="data-mobile" style="display: none;">
                    <div class="flex info">
                        <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= !dans ? data.beatmap.set_id : data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% if (!dans || (data.sacc >= data.dacc && data.sscore >= data.dscore)) { %>
                            <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% } else { %>
                            <img class="grade" src="/image/grade/F.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% } %>
                        <a
                        <% if (!dans && data.beatmap.id > 0) { %>
                            href="/beatmaps/<%= data.beatmap.set_id %>/<%= data.beatmap.id %>"
                                <% } %>>
                            <p class="title"><%= !dans ? data.beatmap.title : data.title %> by <%= !dans ? data.beatmap.artist : data.artist %></p>
                            <p class="diff"><%= !dans ? data.beatmap.version : data.version %></p>
                        </a>
                        <% if (data.mods !== 0) { %>
                            <div class="mods">
                                <% getMods(data.mods).forEach((mod) => { %>
                                    <img title="<%= mod %>" class="img" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                                <% }); %>
                            </div>
                        <% } %>
                    </div>
                    <div class="flex results">
                        <p class="acc">
                            <% if (dans) { %>
                                <%= data.sacc.toFixed(2) %>
                            <% } else { %>
                                <%= data.acc.toFixed(2) %>
                            <% } %>
                            %
                        </p>
                        <p class="recorded">
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else if (data.grade !== "F") { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                -
                            <% } %>
                        </p>
                        <p class="loved">
                            <% if (!dans && data.beatmap.status !== 2 && data.beatmap.status !== 3) { %>
                                (Loved)
                            <% } %>
                        </p>
                    </div>
                </div>
            <% }); %>
        <% } %>
        <!-- Only passed -->
        <% if (rsplays.filter(data => data.grade !== "F") === undefined) { %>
            <h1 class="nothing-passed">No scores available</h1>
        <% } else { %>
            <% rsplays.filter(data => data.grade !== "F").forEach((data) => { %>
                <div class="data-passed">
                    <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= !dans ? data.beatmap.set_id : data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% if (!dans || (data.sacc >= data.dacc && data.sscore >= data.dscore)) { %>
                        <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% } else { %>
                        <img class="grade" src="/image/grade/F.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                    <% } %>
                    <a
                    <% if (!dans && data.beatmap.id > 0) { %>
                        href="/beatmaps/<%= data.beatmap.set_id %>/<%= data.beatmap.id %>"
                            <% } %>
                        style="width: calc(100% - 320px - <%= Math.min(35 * getMods(data.mods).length, 325) %>px);">
                        <p class="title"><%= !dans ? data.beatmap.title : data.title %> by <%= !dans ? data.beatmap.artist : data.artist %></p>
                        <p class="diff"><%= !dans ? data.beatmap.version : data.version %></p>
                    </a>
                    <div class="mods">
                        <% getMods(data.mods).forEach((mod) => { %>
                            <img class="mod" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% }); %>
                    </div>
                    <p class="acc">
                        <% if (dans) { %>
                            <%= data.sacc.toFixed(2) %>
                        <% } else { %>
                            <%= data.acc.toFixed(2) %>
                        <% } %>
                        %
                    </p>
                    <div class="pp">
                        <p class="recorded">
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else if (data.grade !== "F") { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                -
                            <% } %>
                        </p>
                        <p class="loved">
                            <% if (!dans && data.beatmap.status !== 2 && data.beatmap.status !== 3) { %>
                                (Loved)
                            <% } %>
                        </p>
                    </div>
                </div>
                <div class="data-mobile-passed">
                    <div class="flex info">
                        <img class="mapbg" src="https://assets.ppy.sh/beatmaps/<%= !dans ? data.beatmap.set_id : data.set_id %>/covers/cover.jpg?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% if (!dans || (data.sacc >= data.dacc && data.sscore >= data.dscore)) { %>
                            <img class="grade" src="/image/grade/<%= data.grade %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% } else { %>
                            <img class="grade" src="/image/grade/F.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                        <% } %>
                        <a
                        <% if (!dans && data.beatmap.id > 0) { %>
                            href="/beatmaps/<%= data.beatmap.set_id %>/<%= data.beatmap.id %>"
                                <% } %>>
                            <p class="title"><%= !dans ? data.beatmap.title : data.title %> by <%= !dans ? data.beatmap.artist : data.artist %></p>
                            <p class="diff"><%= !dans ? data.beatmap.version : data.version %></p>
                        </a>
                        <% if (data.mods !== 0) { %>
                            <div class="mods">
                                <% getMods(data.mods).forEach((mod) => { %>
                                    <img class="img" src="/image/mods/<%= mod %>.png?<%= date %>" decoding="async" loading="lazy" alt="" />
                                <% }); %>
                            </div>
                        <% } %>
                    </div>
                    <div class="flex results">
                        <p class="acc">
                            <% if (dans) { %>
                                <%= data.sacc.toFixed(2) %>
                            <% } else { %>
                                <%= data.acc.toFixed(2) %>
                            <% } %>
                            %
                        </p>
                        <p class="recorded">
                            <% if (!dans) { %>
                                <%= Math.round(data.pp).toLocaleString() %><span>pp</span>
                            <% } else if (data.grade !== "F") { %>
                                <%= Math.round(data.reward).toLocaleString() %><span>pp</span>
                            <% } else { %>
                                -
                            <% } %>
                        </p>
                        <p class="loved">
                            <% if (!dans && data.beatmap.status !== 2 && data.beatmap.status !== 3) { %>
                                (Loved)
                            <% } %>
                        </p>
                    </div>
                </div>
            <% }); %>
        <% } %>
    </div>
</div>
<% for (let i = 0; i * 50 < rsplays.length; i++) { %>
    <% if (i === 0) { %>
        <% if (rsplays.length > 5) { %>
            <button class="show-more rp to50" style="display: none;">
                <i class="fa-solid fa-chevron-down arrow down"></i>
                show more
                <i class="fa-solid fa-chevron-down arrow down"></i>
            </button>
        <% } %>
    <% } else { %>
        <button class="show-more rp to<%= (i + 1) * 50 %>" style="display: none">
            <i class="fa-solid fa-chevron-down arrow down"></i>
            show more
            <i class="fa-solid fa-chevron-down arrow down"></i>
        </button>
    <% } %>
<% } %>
<% for (let i = 0; i * 50 < rsplays.filter(data => data.grade !== "F").length; i++) { %>
    <% if (i === 0) { %>
        <% if (rsplays.filter(data => data.grade !== "F").length > 5) { %>
            <button class="show-more rp nof to50">
                <i class="fa-solid fa-chevron-down arrow down"></i>
                show more
                <i class="fa-solid fa-chevron-down arrow down"></i>
            </button>
        <% } %>
    <% } else { %>
        <button class="show-more rp nof to<%= (i + 1) * 50 %>" style="display: none">
            <i class="fa-solid fa-chevron-down arrow down"></i>
            show more
            <i class="fa-solid fa-chevron-down arrow down"></i>
        </button>
    <% } %>
<% } %>